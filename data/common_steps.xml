<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <data>

    <template id="step-contract-choice">
      <div id="step-0">
        <div class="clearfix">
          <img class="pull-left" src="/commown_self_troubleshooting/static/images/logo_commown.png"
               alt="Logo de commown" />
          <h2>Appareil concerné</h2>
          <p>Choisissez ci-dessous le contrat dont l'appareil en panne fait l'objet.</p>
        </div>
        <div id="form-step-0" role="form" data-toggle="validator">
          <div class="form-group">
            <label for="device_contract">Contrat de votre appareil :</label>
            <select class="form-control" required="required"
                    id="device_contract" name="device_contract"
                    data-required-error="Veuillez sélectionner un contrat dans la liste ci-dessus.">
              <option disabled="disabled" selected="1" value="">-- Choisir une réponse --</option>
              <t t-foreach="contracts" t-as="c">
                <t t-set="date" t-value="c.date_start.split('-')"/>
                <option
                    t-att-value="c.id"
                    t-esc="u'%s (démarré le %s/%s/%s)' % (c.name, date[2], date[1], date[0])"
                    />
              </t>
            </select>
            <div class="help-block with-errors"></div>
          </div>
        </div>
      </div>
    </template>

    <template id="step-ship-module">
      <div t-attf-id="step-{{ step }}">
        <h2><i class="fa fa-truck" aria-hidden="true"></i> Informations d'expédition</h2>
        <p>Nous allons vous envoyer <t t-esc="new_module"/> pour
        résoudre le problème. Veuillez vérifier attentivement
        les informations d'expédition ci-dessous, et les
        modifier en cas de besoin. Notez que le paquet sera
        déposé directement dans votre boite aux lettres :
        votre présence n'est pas requise lors du passage du
        facteur.</p>
        <div t-attf-id="form-step-{{ step }}" role="form" data-toggle="validator">

          <div class="form-group">
            <label for="name"><i class="fa fa-user" aria-hidden="true"></i> Nom complet</label>
            <input class="form-control" name="name" id="name" required="required" t-att-value="delivery.name" data-required-error="Saisissez un nom pour la livraison."/>
            <div class="help-block with-errors"/>
          </div>

          <div class="form-group">
            <label for="street"><i class="fa fa-home" aria-hidden="true"></i> Rue - 1ère ligne</label>
            <input class="form-control" name="street" id="street" maxlength="35" required="required" t-att-value="delivery.street" data-required-error="Saisissez le numéro et nom de la rue pour la livraison."/>
            <div class="help-block with-errors"/>
          </div>

          <div class="form-group">
            <label for="street2"><i class="fa fa-home" aria-hidden="true"></i> Rue - 2ème ligne (si nécessaire)</label>
            <input class="form-control" name="street2" id="street2" maxlength="35" t-att-value="delivery.street2"/>
            <div class="help-block with-errors"/>
          </div>

          <div class="row">
            <div class="col-xs-4 form-group">
              <label for="zipcode"><i class="fa fa-map-marker" aria-hidden="true"></i> Code postal</label>
              <input class="form-control" name="zipcode" id="zipcode" required="required" t-att-value="delivery.zip" data-required-error="Saisissez un code postal pour la livraison."/>
              <div class="help-block with-errors"/>
            </div>
            <div class="col-xs-4 form-group">
              <label for="city"><i class="fa fa-map-marker" aria-hidden="true"></i> Ville</label>
              <input class="form-control" name="city" id="city" required="required" t-att-value="delivery.city" data-required-error="Saisissez une ville pour la livraison."/>
              <div class="help-block with-errors"/>
            </div>
            <div class="col-xs-4 form-group">
              <label for="country"><i class="fa fa-map-marker" aria-hidden="true"></i> Pays</label>
              <select class="form-control" id="country" name="country" required="required" data-required-error="Saisissez un pays pour la livraison.">
                <option selected="1" t-att-value="delivery.country_id.name"><t t-esc="delivery.country_id.name"/></option>
                <option t-if="delivery.country_id.name != 'France'" value="France">France</option>
                <option t-if="delivery.country_id.name != 'Belgique'" value="Belgique">Belgique</option>
              </select>
              <div class="help-block with-errors"/>
            </div>
          </div>

          <div class="row">
            <div class="col-xs-6 form-group">
              <label for="phone"><i class="fa fa-phone" aria-hidden="true"></i> Numéro de téléphone</label>
              <input class="form-control" name="phone" id="phone" type="tel" required="required" t-att-value="delivery.phone or delivery.mobile" data-required-error="Saisissez un numéro de téléphone pour la livraison."/>
              <div class="help-block with-errors"/>
            </div>
            <div class="col-xs-6 form-group">
              <label for="email"><i class="fa fa-envelope" aria-hidden="true"></i> Adresse email</label>
              <input class="form-control" name="email" id="email" type="email" required="required" t-att-value="delivery.email" data-required-error="Saisissez une adresse email pour la livraison."/>
              <div class="help-block with-errors"/>
            </div>
          </div>

        </div>
      </div>
    </template>

    <template id="step-self-solved">
      <div t-attf-id="step-{{ step }}">
        <h2><i class="fa fa-thumbs-o-up" aria-hidden="true"></i> Problème résolu</h2>
        <p>Vous avez réussi à résoudre le problème, bravo !</p>
        <p>Nous espérons que cet outil vous a été utile pour y parvenir.</p>
        <p>Dans le but de nous aider à améliorer continuellement le service aux
        Commowners (notamment grâce aux statistiques de panne), vous pouvez nous
        faire part de cette expérience au moyen du bouton d'envoi ci-dessous. Si
        vous préférez ne pas nous fournir d'information, fermez simplement cette
        page.
        </p>

        --<br/>
        <p>L'équipe Commown,<br/>
        <img alt="logo" src="https://shop.commown.coop/web/content/25787"/>
        </p>
        --<br/>

        <div t-attf-id="form-step-{{ step }}" role="form" data-toggle="validator">

          <div class="form-group">
            <label t-attf-for="more_info_step_{{ step }}">Ajoutez ici toute information que vous jugerez utile :</label>
            <textarea class="form-control" rows="3" t-attf-id="more_info_step_{{ step }}" name="more_info"/>
          </div>

          <div class="form-group">
            <input type="hidden" name="stage_id" t-att-value="stage_solved"/>
            <button type="submit" class="btn btn-primary" name="action" value="inform">Envoyer les informations</button>
          </div>

        </div>
      </div>
    </template>

  </data>

</odoo>
